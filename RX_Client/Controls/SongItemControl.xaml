<UserControl x:Class="RX_Client.Controls.SongItemControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
             mc:Ignorable="d" 
             d:DesignWidth="800" Height="60">

    <UserControl.Resources>
        <!-- Style để hover đổi màu nền -->
        <Style TargetType="Grid">
            <Setter Property="Background" Value="Transparent"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#1AFFFFFF"/>
                    <!-- Highlight nhẹ -->
                </Trigger>
            </Style.Triggers>
        </Style>
    </UserControl.Resources>

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="50"/>
            <!-- Số thứ tự / Play Icon -->
            <ColumnDefinition Width="60"/>
            <!-- Ảnh bìa -->
            <ColumnDefinition Width="4*"/>
            <!-- Tên bài + Nghệ sĩ -->
            <ColumnDefinition Width="2*"/>
            <!-- Album -->
            <ColumnDefinition Width="60"/>
            <!-- Like Button -->
            <ColumnDefinition Width="60"/>
            <!-- Thời lượng -->
        </Grid.ColumnDefinitions>

        <!-- Cột 1: Số thứ tự / Play Button -->
        <Grid x:Name="IndexContainer" HorizontalAlignment="Center" VerticalAlignment="Center">
            <!-- Số thứ tự (Hiện mặc định) -->
            <TextBlock Text="{Binding Id}" 
                       Foreground="{DynamicResource YtmTextSecondary}" 
                       VerticalAlignment="Center" HorizontalAlignment="Center"
                       x:Name="TxtIndex"/>

            <!-- Icon Play (Hiện khi hover - Xử lý trong Trigger cha hoặc Code Behind đơn giản) -->
            <materialDesign:PackIcon Kind="Play" 
                                     Foreground="White" 
                                     Width="24" Height="24" 
                                     Visibility="Collapsed"
                                     x:Name="IconPlay"/>
        </Grid>

        <!-- Cột 2: Ảnh bìa -->
        <Border Grid.Column="1" Width="40" Height="40" CornerRadius="4" ClipToBounds="True">
            <Image Source="{Binding ThumbnailUrl, TargetNullValue=/Assets/Images/default_cover.png}" Stretch="UniformToFill"/>
        </Border>

        <!-- Cột 3: Thông tin chính -->
        <StackPanel Grid.Column="2" VerticalAlignment="Center" Margin="10,0,0,0">
            <TextBlock Text="{Binding Title}" 
                       Foreground="{DynamicResource YtmTextPrimary}" 
                       FontWeight="Medium" FontSize="14"
                       TextTrimming="CharacterEllipsis"/>
            <TextBlock Text="{Binding ArtistName}" 
                       Foreground="{DynamicResource YtmTextSecondary}" 
                       FontSize="12" Margin="0,2,0,0"/>
        </StackPanel>

        <!-- Cột 4: Tên Album -->
        <TextBlock Grid.Column="3" Text="{Binding AlbumName}" 
                   Foreground="{DynamicResource YtmTextSecondary}" 
                   VerticalAlignment="Center"
                   TextTrimming="CharacterEllipsis"/>

        <!-- Cột 5: Nút Like -->
        <Button Grid.Column="4" Style="{DynamicResource MaterialDesignIconButton}" Foreground="{DynamicResource YtmTextSecondary}">
            <materialDesign:PackIcon Kind="HeartOutline"/>
        </Button>

        <!-- Cột 6: Thời gian -->
        <TextBlock Grid.Column="5" Text="{Binding Duration}" 
                   Foreground="{DynamicResource YtmTextSecondary}" 
                   VerticalAlignment="Center" HorizontalAlignment="Right" Margin="0,0,20,0"/>

        <!-- Logic Hover đơn giản bằng XAML Trigger -->
        <Grid.Triggers>
            <EventTrigger RoutedEvent="MouseEnter">
                <BeginStoryboard>
                    <Storyboard>
                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="TxtIndex" Storyboard.TargetProperty="Visibility">
                            <DiscreteObjectKeyFrame KeyTime="0" Value="{x:Static Visibility.Collapsed}"/>
                        </ObjectAnimationUsingKeyFrames>
                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="IconPlay" Storyboard.TargetProperty="Visibility">
                            <DiscreteObjectKeyFrame KeyTime="0" Value="{x:Static Visibility.Visible}"/>
                        </ObjectAnimationUsingKeyFrames>
                    </Storyboard>
                </BeginStoryboard>
            </EventTrigger>
            <EventTrigger RoutedEvent="MouseLeave">
                <BeginStoryboard>
                    <Storyboard>
                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="TxtIndex" Storyboard.TargetProperty="Visibility">
                            <DiscreteObjectKeyFrame KeyTime="0" Value="{x:Static Visibility.Visible}"/>
                        </ObjectAnimationUsingKeyFrames>
                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="IconPlay" Storyboard.TargetProperty="Visibility">
                            <DiscreteObjectKeyFrame KeyTime="0" Value="{x:Static Visibility.Collapsed}"/>
                        </ObjectAnimationUsingKeyFrames>
                    </Storyboard>
                </BeginStoryboard>
            </EventTrigger>
        </Grid.Triggers>
    </Grid>
</UserControl>